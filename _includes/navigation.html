<!--
    Solution to generate a navigation tree from a data file taken from 
    pdarragh's gist here: https://gist.github.com/pdarragh/c7ca120604c1a1d8b8de
    HUGE props to him.

    [1] First we need to find out what the current page is.
    [2] Build out the menu accordingly.
-->
{% for nav in site.data.nav %}
{% capture fullurl %}{{ site.url }}{{ nav.url }}{% endcapture %}
    {% if fullurl == page.url %}
        {% assign current_page = fullurl %}
        {% break %}
    {% elsif page.url contains fullurl %}
        {% assign current_page = fullurl %}
    {% endif %}
{% endfor %}

<nav id="stacks-nav" role="navigation">
    <a href="index.html" class="stacks-logo">Stacks</a>
    <ul class="-nav">
    {% for nav in site.data.nav %}
        {% if nav.url == current_page %}
            {% assign current = '_selected' %}
        {% else %}
            {% assign current = null %}
        {% endif %}
        {% assign sublinks = nav.sublinks %}
        {% if sublinks %}
        <li class="-item {{ current }}">
            <a href="{{ site.url }}{{ nav.url }}">{{ nav.title }}</a>
            <ul>
                {% for sublink in sublinks %}
                <li class="-item {{ current }}"><a href="{{ site.url }}{{ sublink.url }}">{{ sublink.title }}</a></li>
                {% endfor %}
            </ul>
        </li>
        {% else %}
        <li class="-item {{ current }}">
            <a href="{{ site.url }}{{ nav.url }}">{{ nav.title }}</a>
        </li>
        {% endif %}
    {% endfor %}
    </ul>
</nav>